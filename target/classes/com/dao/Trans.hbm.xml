<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="com.dao.Trans" table="TRANS" schema="MSH">
        <id name="receiptnoTrans" type="java.lang.String">
            <column name="RECEIPTNO_TRANS" length="20" />
            <generator class="assigned" />
        </id>
        <property name="amountTrans" type="java.math.BigDecimal">
            <column name="AMOUNT_TRANS" precision="20" scale="0" />
        </property>
        <property name="dateTrans" type="java.sql.Timestamp">
            <column name="DATE_TRANS" length="7" />
        </property>
    </class>
    
    <!-- 交易明細日期區間 -->
    <sql-query name="trans.query.range">
    <![CDATA[
    select *
    from trans 
    where date_trans  between  
    to_date(:sDate,'YYYYMMDDHH24MISS') 
    and 
    to_date(:eDate,'YYYYMMDDHH24MISS')
     order by date_trans asc
    ]]>
    <return alias="Trans" class="com.dao.Trans"></return>
    </sql-query>
    <!-- 交易總和 -->
    <sql-query name="trans.query.sum">
    <![CDATA[
    select sum(amount_trans)
    from trans 
    where date_trans  between  
    to_date(:sDate,'YYYYMMDDHH24MISS') 
    and 
    to_date(:eDate,'YYYYMMDDHH24MISS')
    
    ]]>
     
    </sql-query>
    
    <!-- 交易明細 -->
    <sql-query name="trans.query.detail">
    <![CDATA[
     select t.*,trans.DATE_TRANS,rownum
    from(
    select *
    from 
    (select RECEIPTNO_SALESITEM receipt,  trim(ITEM_SALESITEM) || ' X '||count_salesItem name1,AMOUNT_SALESITEM amount
    from SALESITEM 
    where RECEIPTNO_SALESITEM =:receiptNo)
    union
    (select receiptno_salesdiscount receipt,name_salesdiscount name1,amount_salesdiscount amount
    from salesDiscount
    where receiptno_salesdiscount =:receiptNo)
    union
    (select receiptno_salesless receipt,name_salesless name1,amount_salesless amount
    from salesless
    where receiptno_salesless=:receiptNo)
    ) t,trans
    where trans.RECEIPTNO_TRANS=:receiptNo
    
    ]]>
     
    </sql-query>
</hibernate-mapping>
